<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="qry_11">
   <cache eviction="LRU" flushInterval="100000" size="1024" readOnly="true"/>
   <select id="71" resultType="Map" parameterType="Map" useCache="false">SELECT
	fu.user_id ,
	fu.user_name ,
	fu.creation_date ,
	fu.isadmin
FROM
	fnd_user fu
WHERE
	 1=1
    <if test="user_name!='' and  user_name!=null">
	  and fu.USER_NAME  like '%${user_name}%'</if>
  </select>
   <select id="72" resultType="Map" parameterType="Map" useCache="false">SELECT
	ppa.PROJECT_ID project_id ,
	ppa. NAME name ,
	ppa.SEGMENT1  segment1,
	ppa.PROJECT_TYPE project_type ,
	DATE_FORMAT(ppa.START_DATE,'%Y-%m-%d')   start_date ,
	DATE_FORMAT(ppa.COMPLETION_DATE,'%Y-%m-%d') completion_date,
    DATE_FORMAT(ppa.CLOSED_DATE ,'%Y-%m-%d')     closed_date,
	ppa.PROJECT_STATUS_CODE project_status_code
FROM
	pa_projects_all ppa
WHERE
1=1
    <if test="project_code!='' and  project_code!=null">
and	ppa.SEGMENT1 = #{project_code}</if>
     <if test="project_type!='' and  project_type!=null">
AND ppa.PROJECT_TYPE = #{project_type}</if>
     <if test="project_state!='' and  project_state!=null">
AND ppa.PROJECT_STATUS_CODE&gt;=#{project_state}</if>
  </select>
   <select id="82" resultType="Map" parameterType="Map" useCache="false">select ffv.flex_value,
       ffvt.description
 from fnd_id_flex_segments fifs,
gl_sets_of_books     gsob,
       fnd_flex_values      ffv,
       fnd_flex_values_tl   ffvt
 where gsob.chart_of_accounts_id = fifs.id_flex_num
   and id_flex_code = 'GL#'
 and ffv.flex_value_id = ffvt.flex_value_id
   and ffvt.language = 'ZHS'
   and ffv.flex_value_set_id = fifs.flex_value_set_id
   and ffv.enabled_flag = 'Y'
 and ffv.end_date_active is null
   and gsob.set_of_books_id = 2
   and fifs.application_column_name = 'SEGMENT1'
 order by ffv.flex_value</select>
   <select id="83" resultType="Map" parameterType="Map" useCache="false">SELECT nvl(SUM(gb.period_net_dr), 0) AS period_net_dr
FROMgl_balances gb, gl_code_combinations gcc
WHERE gb.code_combination_id = gcc.code_combination_id
	AND gcc.summary_flag = 'N'
	AND gb.set_of_books_id = 2
	AND gb.period_name = #{period}
	AND gcc.segment1 LIKE '${segment1}%'
	AND gcc.segment2 = #{segment2}
	AND gcc.segment3 LIKE '${segment3}%'</select>
   <select id="84" resultType="Map" parameterType="Map" useCache="false">SELECT
	ph.segment1 po_number,
	ph.creation_date  ,
	ph.vendor_id ,
	pv.VENDOR_NAME ,
	ph.ORG_ID org_id ,
	hao.attribute1 ,
	hao. NAME ou_name ,
	pl.line_num ,
	pl.item_id ,
	pl.unit_price ,
	pl.quantity
FROM
	po_headers_all ph ,
	po_lines_all pl ,
	po_vendors pv ,
	hr_all_organization_units hao
WHERE
	pl.po_header_id = ph.po_header_id
AND ph.VENDOR_ID = pv.VENDOR_ID
AND ph.org_id = hao.organization_id
AND pv.VENDOR_NAME LIKE '%${VENDOR_NAME}%'
AND ph.SEGMENT1 = '${po_number}'
AND ph.CREATION_DATE BETWEEN '${beginDate}'
AND '${endDate}'
AND hao.attribute1 = '${org_id}'</select>
</mapper>
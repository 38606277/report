<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="bdTableColumn">
	<!-- db_table增删改查********************************************************************** -->
	<!--  创建bd_model信息  -->
	<insert id="createTableColumn" parameterType="Map" useGeneratedKeys="true" keyProperty="id">
		insert into bd_table_column(id,table_id,column_name,column_code,column_type,column_source,column_desc)
		values (#{id},#{table_id},#{column_name},#{column_code},#{column_type},#{column_source},#{column_desc})
	</insert>
	<!-- 修改 bd_model表的信息 -->
	<update id="updateTableColumn" parameterType="Map">
		update bd_table_column set column_name='${column_name}',column_code='${column_code}',column_type='${column_type}',
		column_source='${column_source}',column_desc='${column_desc}'
		where id=#{id,jdbcType=INTEGER}
	</update>

	<select id="getMaxId" resultType="java.lang.Integer">
        SELECT (MAX(id) +1)as id from bd_table_column
    </select>

	<select id="getBdTableById" parameterType="java.lang.Integer" resultType="map">
        SELECT bd.* FROM bd_table bd where bd.table_id = #{table_id}
    </select>

    <select id="getListPage" resultType="Map" parameterType="Map">
        SELECT bd.*  FROM bd_table bd  where  1=1
		<if  test="table_name != null and table_name!='' ">
			and  bd.table_name like '%${table_name}%'
		</if>
		<if  test="table_title != null and table_title!='' ">
			and  bd.table_title ='${table_title}'
		</if>
		<if  test="model_id != null and model_id!='' ">
			and  bd.model_id = '${model_id}'
		</if>
    </select>

	<!-- 根据model_id 删除表相关信息  -->
	<delete id="deleteBdTableByID" parameterType="Map">
        delete from bd_table where table_id=#{table_id}
    </delete>

	<!-- bd_model_table 增删查 ***********************************************************-->

	<insert id="createBdModelTable" parameterType="Map" >
		insert into bd_model_table(model_id,table_id) values (#{model_id},#{table_id})
	</insert>

	<delete id="deleteBdModelTableByTableIdOrModelId" parameterType="Map" >
		 delete from  bd_model_table where
		 <if  test="table_id != null and table_id!='' ">
			 table_id = #{table_id}
		</if>
		<if  test="model_id != null and model_id!='' ">
			 model_id = #{model_id}
		</if>
	</delete>


</mapper>

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dbmodelTable">
	<!-- db_table增删改查********************************************************************** -->
	<!--  创建bd_model信息  -->
	<insert id="createBdTable" parameterType="Map" useGeneratedKeys="true" keyProperty="id">
		insert into bd_table(table_id,table_name,table_title,model_id,table_ddl,create_date,create_by,update_date,update_by)
		values (#{table_id},'${table_name}','${table_title}','${model_id}','${table_ddl}',SYSDATE(),'${create_by}',SYSDATE(),'${update_by}')
	</insert>
	<!-- 修改 bd_model表的信息 -->
	<update id="updateBdTable" parameterType="Map">
		update bd_table set table_name='${table_name}',table_title='${table_title}',model_id='${model_id}',
		table_ddl='${table_ddl}',update_date=SYSDATE(),	update_by='${update_by}'
		where table_id=#{table_id,jdbcType=INTEGER}
	</update>

	<select id="getMaxId" resultType="java.lang.Integer">
        SELECT (MAX(table_id) +1)as table_id from bd_table
    </select>

	<select id="getBdTableById" parameterType="java.lang.Integer" resultType="map">
        SELECT bd.* FROM bd_table bd where bd.table_id = #{table_id}
    </select>

    <select id="getListPage" resultType="Map" parameterType="Map">
        SELECT bd.*  FROM bd_table bd  where  1=1
		<if  test="table_name != null and table_name!='' ">
			and  bd.table_name like '%${table_name}%'
		</if>
		<if  test="table_title != null and table_title!='' ">
			and  bd.table_title ='${table_title}'
		</if>
		<if  test="model_id != null and model_id!='' ">
			and  bd.model_id = '${model_id}'
		</if>
    </select>

	<!-- 根据model_id 删除表相关信息  -->
	<delete id="deleteBdTableByID" parameterType="Map">
        delete from bd_table where table_id=#{table_id}
    </delete>

	<!-- bd_model_table 增删查 ***********************************************************-->

	<insert id="createBdModelTable" parameterType="Map" >
		insert into bd_model_table(model_id,table_id) values (#{model_id},#{table_id})
	</insert>

	<delete id="deleteBdModelTableByTableIdOrModelId" parameterType="Map" >
		 delete from  bd_model_table where
		 <if  test="table_id != null and table_id!='' ">
			 table_id = #{table_id}
		</if>
		<if  test="model_id != null and model_id!='' ">
			 model_id = #{model_id}
		</if>
	</delete>


</mapper>

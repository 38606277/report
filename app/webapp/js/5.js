webpackJsonp([5],{1583:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(460),i=a(o),f=n(479),c=a(f),s=n(451),d=a(s),p=n(507),m=a(p),b=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(461),n(481),n(454),n(508);var y=n(10),h=a(y),v=n(150),E=n(672),w=a(E),g=new w.default,_=function(e){function t(e){r(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={list:[]},n}return u(t,e),b(t,[{key:"componentDidMount",value:function(){this.loadDbList()}},{key:"loadDbList",value:function(){var e=this,t={};g.getDbList(t).then(function(t){e.setState({list:t})},function(t){e.setState({list:[]})})}},{key:"deleteDb",value:function(e){var t=this;confirm("确认删除吗？")&&g.deleteDb(e).then(function(e){alert("删除成功"),t.loadDbList()},function(e){alert("删除失败")})}},{key:"render",value:function(){var e=this;this.state.list.map(function(e,t){e.key=t});var t=this.state.list,n=[{title:"连接名称",dataIndex:"name",key:"name",render:function(e,t,n){return h.default.createElement(v.Link,{to:"/dbs/dbView/"+t.name},e)}},{title:"连接类型",dataIndex:"dbtype",key:"dbtype"},{title:"操作",dataIndex:"操作",render:function(t,n){return h.default.createElement("span",null,h.default.createElement(v.Link,{to:"/dbs/dbInfo/"+n.name},"编辑"),h.default.createElement(m.default,{type:"vertical"}),"system"!=n.name&&"form"!=n.name?h.default.createElement("a",{onClick:function(){return e.deleteDb(""+n.name)},href:"javascript:;"},"删除"):"")}}];return h.default.createElement("div",{id:"page-wrapper"},h.default.createElement(i.default,{title:"连接管理"},h.default.createElement(d.default,{href:"#/dbs/dbInfo/null",style:{float:"right",marginRight:"30px",marginBottom:"10px"},type:"primary"},"新建连接"),h.default.createElement(c.default,{dataSource:t,columns:n,pagination:!1,style:{marginTop:"30px"}})))}}]),t}(h.default.Component);t.default=_},1584:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(460),f=a(i),c=n(451),s=a(c),d=n(487),p=a(d),m=n(488),b=a(m),y=n(463),h=a(y),v=n(472),E=a(v),w=n(482),g=a(w),_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},O=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(461),n(454),n(502),n(503),n(444),n(485),n(483);var j=n(10),D=a(j),k=n(672),S=a(k),C=n(151),x=a(C),P=new x.default,B=g.default.Item,M=E.default.Option,T=new S.default,L=function(e){function t(e){l(this,t);var n=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={confirmDirty:!1,_name:n.props.match.params.name},n.handleSubmit=n.handleSubmit.bind(n),n.handleConfirmBlur=n.handleConfirmBlur.bind(n),n}return o(t,e),O(t,[{key:"componentDidMount",value:function(){var e=this;null!=this.state._name&&""!=this.state._name&&"null"!=this.state._name&&T.getDb(this.state._name).then(function(t){e.props.form.setFieldsValue(t)},function(t){e.setState({}),P.errorTips(t)})}},{key:"onSelectChange",value:function(e,t){var n,a=null,l=null;"Oracle"==t?(a="oracle.jdbc.OracleDriver",l="jdbc:oracle:thin:@ip:port:xe"):"Mysql"==t?(a="com.mysql.cj.jdbc.Driver",l="jdbc:mysql://ip:port/xe"):"DB2"==t?(a="com.ibm.db2.jcc.DB2Driver",l="jdbc:db2://ip:port/xe"):"mongoDB"==t&&(a="",l="ip:port"),this.props.form.setFieldsValue((n={},r(n,e,t),r(n,"driver",a),r(n,"url",l),n))}},{key:"onValueChange",value:function(e){var t=e.target.name,n=e.target.value.trim();this.props.form.setFieldsValue(r({},t,n))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFieldsAndScroll(function(e,n){e||(n._name=t.state._name,T.saveDb(n).then(function(e){alert("保存成功"),window.location.href="#/dbs"},function(e){t.setState({}),P.errorTips(e)}))})}},{key:"handleConfirmBlur",value:function(e){var t=e.target.value;this.setState({confirmDirty:this.state.confirmDirty||!!t})}},{key:"clickTest",value:function(){var e=this;this.props.form.validateFieldsAndScroll(function(t,n){t||T.testDb([e.values,"update"]).then(function(e){alert(e.retMsg)},function(e){alert("连接失败")})})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,n={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},a={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}};return D.default.createElement("div",{id:"page-wrapper"},D.default.createElement(f.default,{title:"null"==this.state._name?"新建连接":"编辑连接"},D.default.createElement(g.default,{onSubmit:this.handleSubmit},D.default.createElement(p.default,null,D.default.createElement(b.default,{span:12},D.default.createElement(B,_({},n,{label:"连接名称"}),t("name",{rules:[{required:!0,message:"请输入连接名称!"}]})(D.default.createElement(h.default,{type:"text",name:"name"})))),D.default.createElement(b.default,{span:12},D.default.createElement(B,_({},n,{label:"数据库类型"}),t("dbtype",{rules:[{required:!0,message:"请选择数据库类型!",whitespace:!0}]})(D.default.createElement(E.default,{name:"dbtype",style:{width:120},onChange:function(t){return e.onSelectChange("dbtype",t)}},D.default.createElement(M,{value:"Oracle"},"Oracle"),D.default.createElement(M,{value:"Mysql"},"Mysql"),D.default.createElement(M,{value:"DB2"},"DB2"),D.default.createElement(M,{value:"mongoDB"},"mongoDB")))))),D.default.createElement(p.default,null,D.default.createElement(b.default,{span:12},D.default.createElement(B,_({},n,{label:"驱动类型"}),t("driver",{rules:[{required:!0,message:"请输入驱动类型!",whitespace:!0}]})(D.default.createElement(h.default,{type:"text",name:"driver"})))),D.default.createElement(b.default,{span:12},D.default.createElement(B,_({},n,{label:"地址"}),t("url",{rules:[{required:!0,message:"请输入驱动类型!",whitespace:!0}]})(D.default.createElement(h.default,{type:"text",name:"url"}))))),D.default.createElement(p.default,null,D.default.createElement(b.default,{span:12},D.default.createElement(B,_({},n,{label:"用户名"}),t("username",{rules:[{required:!0,message:"请输入用户名!",whitespace:!0}]})(D.default.createElement(h.default,{type:"text",name:"username"})))),D.default.createElement(b.default,{span:12},D.default.createElement(B,_({},n,{label:"密码"}),t("password",{rules:[{required:!1,message:"请输入密码!",whitespace:!0}]})(D.default.createElement(h.default,{type:"text",name:"password"}))))),D.default.createElement(B,a,D.default.createElement(s.default,{type:"primary",onClick:function(){return e.clickTest()}},"测试"),D.default.createElement(s.default,{type:"primary",htmlType:"submit",style:{marginLeft:"30px"}},"保存"),D.default.createElement(s.default,{href:"#/dbs",type:"primary",style:{marginLeft:"30px"}},"返回")))))}}]),t}(D.default.Component);t.default=g.default.create()(L)},1585:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(460),i=a(o),f=n(451),c=a(f),s=n(487),d=a(s),p=n(488),m=a(p),b=n(472),y=a(b),h=n(482),v=a(h),E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},w=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(461),n(454),n(502),n(503),n(485),n(483);var g=n(10),_=a(g),O=n(672),j=a(O),D=n(151),k=a(D),S=new k.default,C=v.default.Item,x=(y.default.Option,new j.default),P=function(e){function t(e){r(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={name:n.props.match.params.name},n}return u(t,e),w(t,[{key:"componentDidMount",value:function(){var e=this;x.getDb(this.state.name).then(function(t){e.setState(t)},function(t){e.setState({}),S.errorTips(t)})}},{key:"render",value:function(){var e=(this.props.form.getFieldDecorator,{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}}),t={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}};return _.default.createElement("div",{id:"page-wrapper"},_.default.createElement(i.default,{title:"查看连接"},_.default.createElement(v.default,{onSubmit:this.handleSubmit},_.default.createElement(d.default,null,_.default.createElement(m.default,{span:12},_.default.createElement(C,E({},e,{label:"连接名称"}),this.state.name)),_.default.createElement(m.default,{span:12},_.default.createElement(C,E({},e,{label:"连接类型"}),this.state.dbtype))),_.default.createElement(d.default,null,_.default.createElement(m.default,{span:12},_.default.createElement(C,E({},e,{label:"驱动类型"}),this.state.driver)),_.default.createElement(m.default,{span:12},_.default.createElement(C,E({},e,{label:"地址"}),this.state.url))),_.default.createElement(d.default,null,_.default.createElement(m.default,{span:12},_.default.createElement(C,E({},e,{label:"用户名"}),this.state.username)),_.default.createElement(m.default,{span:12},_.default.createElement(C,E({},e,{label:"密码"}),this.state.password))),_.default.createElement(C,t,_.default.createElement(c.default,{href:"#/dbs",type:"primary"},"返回")))))}}]),t}(_.default.Component);t.default=v.default.create()(P)},404:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(10),f=a(i),c=n(150),s=n(1583),d=a(s),p=n(1584),m=a(p),b=n(1585),y=a(b),h=function(e){function t(){return r(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),o(t,[{key:"render",value:function(){return f.default.createElement(c.Switch,null,f.default.createElement(c.Route,{path:"/dbs/dbsList",component:d.default}),f.default.createElement(c.Route,{path:"/dbs/dbInfo/:name",component:m.default}),f.default.createElement(c.Route,{path:"/dbs/dbView/:name",component:y.default}),f.default.createElement(c.Redirect,{exact:!0,from:"/dbs",to:"/dbs/dbsList"}))}}]),t}(f.default.Component);t.default=h},672:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(466),u=function(e){return e&&e.__esModule?e:{default:e}}(l),o=function(){function e(){a(this,e)}return r(e,[{key:"getDbList",value:function(){var e={};return u.default.post("reportServer/DBConnection/ListAll",e)}},{key:"getDb",value:function(e){return u.default.post("reportServer/DBConnection/GetByName",e)}},{key:"saveDb",value:function(e){if("null"==e._name){return u.default.post("reportServer/DBConnection/save",JSON.stringify(e))}return u.default.post("reportServer/DBConnection/update",JSON.stringify(e))}},{key:"deleteDb",value:function(e){return u.default.post("reportServer/DBConnection/Delete",e)}},{key:"testDb",value:function(e){return u.default.post("reportServer/DBConnection/test",JSON.stringify(e))}}]),e}();t.default=o}});
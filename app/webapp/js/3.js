webpackJsonp([3],{1598:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(460),s=n(i),f=a(479),c=n(f),d=a(451),p=n(d),h=a(491),m=n(h),y=a(507),g=n(y),v=a(463),b=n(v),w=a(482),E=n(w),_=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a(461),a(481),a(454),a(506),a(508),a(444),a(483);var S=a(10),N=n(S),I=a(150),k=a(1350),O=n(k),C=a(540),P=n(C),R=a(151),j=n(R);a(1599);var x=(E.default.Item,new j.default),L=new O.default,U=b.default.Search,T=function(e){function t(e){l(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={list:[],pageNum:1,perPage:10,listType:"list",roleName:""},a}return u(t,e),_(t,[{key:"componentDidMount",value:function(){this.loadUserList()}},{key:"loadUserList",value:function(){var e=this,t={};t.pageNum=this.state.pageNum,t.perPage=this.state.perPage,"search"===this.state.listType&&(t.roleName=this.state.roleName),L.getRoleList(t).then(function(t){e.setState(t)},function(t){e.setState({list:[]})})}},{key:"onPageNumChange",value:function(e){var t=this;this.setState({pageNum:e},function(){t.loadUserList()})}},{key:"onValueChange",value:function(e){var t=e.target.name,a=e.target.value.trim();this.setState(r({},t,a))}},{key:"onSearch",value:function(e){var t=this,a=""===e?"list":"search";this.setState({listType:a,pageNum:1,roleName:e},function(){t.loadUserList()})}},{key:"deleteRole",value:function(e){var t=this;confirm("确认删除吗？")&&L.delRole(e).then(function(e){alert("删除成功"),t.loadUserList()},function(e){alert("删除失败")})}},{key:"render",value:function(){var e=this;this.state.list.map(function(e,t){e.key=t});var t=(x.getStorage("userInfo"),this.state.list),a=[{title:"ID",dataIndex:"roleId",key:"roleId",className:"headerRow"},{title:"角色名称",dataIndex:"roleName",key:"roleName",className:"headerRow"},{title:"是否启用",dataIndex:"enabledText",key:"enabledText",className:"headerRow"},{title:"创建时间",dataIndex:"createdDate",key:"createdDate",className:"headerRow"},{title:"操作",dataIndex:"操作",className:"headerRow",render:function(t,a){return N.default.createElement("span",null,N.default.createElement(I.Link,{to:"/role/roleInfo/"+a.roleId},"编辑"),N.default.createElement(g.default,{type:"vertical"}),N.default.createElement("a",{onClick:function(){return e.deleteRole(""+a.roleId)},href:"javascript:;"},"删除"),N.default.createElement(g.default,{type:"vertical"}),N.default.createElement(I.Link,{to:"/role/roleUser/"+a.roleId},"分配用户"),N.default.createElement(g.default,{type:"vertical"}),N.default.createElement(I.Link,{to:"/rule/ruleInfo/"+a.roleId},"分配权限"))}}];return N.default.createElement("div",{id:"page-wrapper"},N.default.createElement(s.default,{title:"角色列表"},N.default.createElement(m.default,null,N.default.createElement(U,{style:{width:300,marginBottom:"10px"},placeholder:"请输入...",enterButton:"查询",onSearch:function(t){return e.onSearch(t)}})),N.default.createElement(m.default,null,N.default.createElement(p.default,{href:"#/role/roleInfo/null",style:{float:"right",marginRight:"30px"},type:"primary"},"新建角色")),N.default.createElement(c.default,{dataSource:t,columns:a,pagination:!1}),N.default.createElement(P.default,{current:this.state.pageNum,total:this.state.total,onChange:function(t){return e.onPageNumChange(t)}})))}}]),t}(N.default.Component);t.default=T},1599:function(e,t,a){var n=a(1600);"string"==typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0};r.transform=void 0;a(400)(n,r);n.locals&&(e.exports=n.locals)},1600:function(e,t,a){t=e.exports=a(399)(!1),t.push([e.i,".ant-table-tbody .headerRow,.ant-table-thead .headerRow{text-align:center}",""])},1601:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(460),s=n(i),f=a(451),c=n(f),d=a(487),p=n(d),h=a(488),m=n(h),y=a(463),g=n(y),v=a(472),b=n(v),w=a(482),E=n(w),_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},S=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a(461),a(454),a(502),a(503),a(444),a(485),a(483);var N=a(10),I=n(N),k=a(1350),O=n(k),C=a(1326),P=(n(C),a(421)),R=(n(P),a(151)),j=n(R),x=new j.default,L=E.default.Item,U=new O.default,T=b.default.Option,B=function(e){function t(e){l(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={confirmDirty:!1,_id:a.props.match.params.roleId,roleId:"",roleName:"",enabled:"1"},a.handleSubmit=a.handleSubmit.bind(a),a.handleConfirmBlur=a.handleConfirmBlur.bind(a),a}return u(t,e),S(t,[{key:"componentDidMount",value:function(){var e=this;null!=this.state._id&&""!=this.state._id&&"null"!=this.state._id&&U.getRoleInfo(this.state._id).then(function(t){e.setState(t),e.props.form.setFieldsValue({roleName:t.roleName,enabled:t.enabled.toString(),roleId:t.roleId,confirm:""})},function(t){e.setState({}),x.errorTips(t)})}},{key:"onValueChange",value:function(e){var t=e.target.name,a=e.target.value.trim();this.setState(r({},t,a)),this.props.form.setFieldsValue(r({},t,a))}},{key:"onSelectChange",value:function(e,t){this.setState(r({},e,t)),this.props.form.setFieldsValue(r({},e,t))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFieldsAndScroll(function(e,a){e||U.saveRoleInfo(t.state).then(function(e){null!=t.state._id&&""!=t.state._id&&"null"!=t.state._id?alert("修改成功"):alert("保存成功"),window.location.href="#role/roleList"},function(e){t.setState({}),x.errorTips(e)})})}},{key:"handleConfirmBlur",value:function(e){var t=e.target.value;this.setState({confirmDirty:this.state.confirmDirty||!!t})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},n={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}};return I.default.createElement("div",{id:"page-wrapper"},I.default.createElement(s.default,{title:"null"==this.state._id?"新建角色":"编辑角色"},I.default.createElement(E.default,{onSubmit:this.handleSubmit},I.default.createElement(p.default,null,I.default.createElement(m.default,{span:12},I.default.createElement(L,_({},a,{label:"角色名称"}),t("roleName",{rules:[{required:!0,message:"请输入角色名称!"}]})(I.default.createElement(g.default,{type:"text",name:"roleName",onChange:function(t){return e.onValueChange(t)}})))),I.default.createElement(m.default,{span:12},I.default.createElement(L,_({},a,{label:"是否启用"}),I.default.createElement(b.default,{name:"enabled",value:this.state.enabled.toString(),style:{width:120},onChange:function(t){return e.onSelectChange("enabled",t)}},I.default.createElement(T,{value:"1"},"启用"),I.default.createElement(T,{value:"0"},"禁用"))))),I.default.createElement(L,n,I.default.createElement(c.default,{type:"primary",htmlType:"submit"},"保存"),I.default.createElement(c.default,{href:"#/role/roleList",type:"primary",style:{marginLeft:"30px"}},"返回")))))}}]),t}(I.default.Component);t.default=E.default.create()(B)},1602:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=a(451),i=n(u),s=a(460),f=n(s),c=a(479),d=n(c),p=a(491),h=n(p),m=a(472),y=n(m),g=a(585),v=n(g),b=a(463),w=n(b),E=a(1406),_=n(E),S=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a(454),a(461),a(481),a(506),a(485),a(588),a(444),a(1408);var N=a(10),I=n(N),k=(a(150),a(1350)),O=n(k),C=a(1087),P=n(C),R=a(540),j=n(R),x=(_.default.TreeNode,new O.default),L=new P.default,U=w.default.Search,T=(v.default.TabPane,y.default.Option,function(e){function t(e){r(this,t);var a=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.onSelectChange=function(e){a.setState({selectedRowKeys:e})};return a.newTabIndex=0,a.state={roleId:a.props.match.params.roleId,list:[],userList:[],pageNum:1,perPage:10,listType:"list",selectedRowKeys:[],roleName:"",pageNumUser:1,perPageUser:10},a}return o(t,e),S(t,[{key:"componentDidMount",value:function(){this.loadRoleList(this.state.roleId),this.loadUserList()}},{key:"loadRoleList",value:function(e){var t=this,a={};a.pageNum=this.state.pageNum,a.perPage=this.state.perPage,"search"===this.state.listType&&(a.roleName=this.state.roleName),null!=e&&""!=e&&this.getUserByroleId(e),x.getRoleList(a).then(function(e){t.setState(e)},function(e){t.setState({list:[]})})}},{key:"getUserByroleId",value:function(e){var t=this,a=[];x.getUserListByRoleId(e).then(function(e){e.map(function(e,t){a.push(e.user_id)}),t.setState({selectedRowKeys:a})},function(e){t.setState({selectedRowKeys:[]})})}},{key:"onValueChange",value:function(e){var t=(e.target.name,e.target.value.trim());this.setState({roleName:t})}},{key:"onSearch",value:function(){var e=this;this.setState({pageNum:1,listType:"search"},function(){e.loadRoleList()})}},{key:"onPageNumChange",value:function(e){var t=this;this.setState({pageNum:e},function(){t.loadRoleList()})}},{key:"loadUserList",value:function(){var e=this,t={};t.pageNumUser=this.state.pageNumUser,t.perPageUser=this.state.perPageUser,L.getUserListRole(t).then(function(t){e.setState({userList:t.data.list,userTotal:t.data.total})},function(t){e.setState({userList:[]})})}},{key:"onPageNumChangeUser",value:function(e){var t=this;this.setState({pageNumUser:e},function(){t.loadUserList()})}},{key:"selectedOnchage",value:function(e,t){this.setState({roleName:t}),this.getUserByroleId(e)}},{key:"saveUserId",value:function(){var e=this,t={roleId:this.state.roleId,userList:this.state.selectedRowKeys};x.saveUserId(t).then(function(e){alert("success")},function(t){e.setState({userList:[]})})}},{key:"render",value:function(){var e=this;this.state.list.map(function(e,t){e.key=e.index}),this.state.userList.map(function(e,t){e.key=e.id});var t=this.state.list,a=[{dataIndex:"roleName",key:"roleName",render:function(t,a){return I.default.createElement("a",{href:"javascript:;",onClick:function(){return e.selectedOnchage(a.roleId,a.roleName)}},a.roleName)}}],n=this.state.userList,r=[{title:"ID",dataIndex:"userId",key:"userId"},{title:"用户名",dataIndex:"userName"}],l=this.state.selectedRowKeys,o={selectedRowKeys:l,onChange:this.onSelectChange};return I.default.createElement("div",{id:"page-wrapper"},I.default.createElement(f.default,{title:"角色列表",style:{float:"left",width:"20%"}},I.default.createElement(h.default,null,I.default.createElement(U,{style:{width:190,marginBottom:"10px",marginLeft:"-20px",marginRight:"-30px",border:"0"},placeholder:"请输入...",enterButton:"查询",onSearch:function(t){return e.onSearch(t)},onChange:function(t){return e.onValueChange(t)},value:this.state.roleName})),I.default.createElement(d.default,{dataSource:t,columns:a,pagination:!1,showHeader:!1,style:{marginLeft:"-30px",marginRight:"-30px",border:"0"}}),I.default.createElement(j.default,{current:this.state.pageNum,total:this.state.total,onChange:function(t){return e.onPageNumChange(t)}})),I.default.createElement(f.default,{title:"用户列表",style:{float:"left",width:"80%"}},I.default.createElement(h.default,null,I.default.createElement(i.default,{type:"primary",onClick:function(){return e.saveUserId()},style:{marginBottom:"10px"}},"保存")),I.default.createElement(d.default,{rowSelection:o,columns:r,dataSource:n,pagination:!1}),I.default.createElement(j.default,{current:this.state.pageNumUser,total:this.state.userTotal,onChange:function(t){return e.onPageNumChangeUser(t)}})))}}]),t}(I.default.Component));t.default=T},406:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(10),s=n(i),f=a(150),c=a(1598),d=n(c),p=a(1601),h=n(p),m=a(1602),y=n(m),g=a(1463),v=n(g),b=function(e){function t(){return r(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),u(t,[{key:"render",value:function(){return s.default.createElement(f.Switch,null,s.default.createElement(f.Route,{path:"/rule/ruleInfo/:roleId",component:v.default}),s.default.createElement(f.Route,{path:"/role/roleList",component:d.default}),s.default.createElement(f.Route,{path:"/role/roleInfo/:roleId",component:h.default}),s.default.createElement(f.Route,{path:"/role/roleUser/:roleId",component:y.default}),s.default.createElement(f.Redirect,{exact:!0,from:"/role",to:"/role/roleList"}))}}]),t}(s.default.Component);t.default=b}});